<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ليالي العرب UHD | نظام تخطي الحظر</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;900&display=swap');
        body { background: #000; color: #fff; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
        .gold-glow { color: #d4af37; text-shadow: 0 0 15px rgba(212, 175, 55, 0.6); }
        .card-uhd { background: #050505; border: 1px solid #111; transition: 0.4s; cursor: pointer; position: relative; overflow: hidden; border-radius: 12px; }
        .card-uhd:hover { border-color: #d4af37; transform: translateY(-10px); box-shadow: 0 0 20px rgba(212, 175, 55, 0.2); }
        #player-overlay { position: fixed; inset: 0; background: #000; z-index: 9999; display: none; flex-direction: column; }
        iframe { width: 100%; height: 100%; border: none; }
        .search-bypass { background: #0a0a0a; border: 1px solid #d4af37; padding: 15px; border-radius: 50px; width: 100%; outline: none; text-align: center; color: #d4af37; font-weight: bold; }
    </style>
</head>
<body>

    <div id="player-overlay">
        <div class="p-4 bg-zinc-900 flex justify-between items-center">
            <span class="gold-glow font-black uppercase tracking-widest">Layali Arab Server v4.0</span>
            <button onclick="closePlayer()" class="bg-red-600 px-8 py-2 rounded-full font-black hover:bg-red-700 transition">إغلاق ×</button>
        </div>
        <div id="video-container" class="flex-1"></div>
    </div>

    <header class="p-10 text-center border-b border-zinc-900 bg-zinc-950">
        <h1 class="text-5xl font-black gold-glow mb-4 animate__animated animate__pulse animate__infinite">LAYALI ARAB</h1>
        <p class="text-gray-500 text-xs mb-8 uppercase tracking-[10px]">The Ultimate Cinema Bypass</p>
        
        <div class="max-w-2xl mx-auto relative">
            <input type="text" id="targetSearch" placeholder="اكتب اسم الفيلم بالإنجليزية (مثلاً: Joker)" class="search-bypass focus:shadow-[0_0_20px_#d4af37]">
            <button onclick="manualInject()" class="mt-4 bg-[#d4af37] text-black px-10 py-3 rounded-full font-black hover:scale-105 transition">جلب وتشغيل فوري ⚡</button>
        </div>
    </header>

    <main class="p-10">
        <div class="flex items-center gap-4 mb-10">
            <div class="h-[2px] w-20 bg-[#d4af37]"></div>
            <h2 class="text-2xl font-black uppercase">أفلام جاهزة للمشاهدة (بدون انترنت)</h2>
        </div>

        <div id="movieGrid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6">
            </div>
    </main>

    <script>
        // مفتاح احتياطي
        const API_KEY = '8d6d9194546435662aa063955619f697';
        
        // قاعدة بيانات "الطوارئ" - تظهر حتى لو الـ API محظور
        const emergencyDb = [
            { id: 414906, title: "The Batman", img: "https://image.tmdb.org/t/p/w500/v9Qo5Xm07XmX6vEaPStandard.jpg" },
            { id: 299536, title: "Avengers: Endgame", img: "https://image.tmdb.org/t/p/w500/or06vSzzRfbi0C2zTqTp7FJlmAD.jpg" },
            { id: 634649, title: "Spider-Man: No Way Home", img: "https://image.tmdb.org/t/p/w500/1g0m2zWyQnZ9p6Wovp9pXjAtpMQ.jpg" },
            { id: 550, title: "Fight Club", img: "https://image.tmdb.org/t/p/w500/pB8S7SvMTHGvguJu5oTMpYIStandard.jpg" },
            { id: 157336, title: "Interstellar", img: "https://image.tmdb.org/t/p/w500/gEU2QniE6E77NI6vS6o6oPEgx6A.jpg" },
            { id: 475557, title: "Joker", img: "https://image.tmdb.org/t/p/w500/udDcl707OTZ8O7nTBpNBqIB0IBg.jpg" }
        ];

        async function init() {
            const grid = document.getElementById('movieGrid');
            try {
                // محاولة جلب البيانات الأصلية
                const resp = await fetch(`https://api.themoviedb.org/3/movie/popular?api_key=${API_KEY}&language=ar-SA`);
                if (!resp.ok) throw new Error();
                const data = await resp.json();
                render(data.results);
            } catch (e) {
                // إذا فشل (بسبب الحجب)، استخدم قاعدة بيانات الطوارئ
                console.log("Using Emergency Database due to block.");
                render(emergencyDb);
                Swal.fire({
                    title: 'تنبيه النظام',
                    text: 'تم رصد حظر من مزود الإنترنت، تم تفعيل وضع التخطي بنجاح.',
                    icon: 'info', background: '#000', color: '#d4af37', confirmButtonColor: '#d4af37'
                });
            }
        }

        function render(movies) {
            const grid = document.getElementById('movieGrid');
            grid.innerHTML = '';
            movies.forEach(m => {
                const card = document.createElement('div');
                card.className = 'card-uhd animate__animated animate__zoomIn';
                // استخدام رابط صورة بديل إذا فشل الأصلي
                const poster = m.poster_path ? `https://image.tmdb.org/t/p/w500${m.poster_path}` : m.img;
                card.innerHTML = `
                    <img src="${poster}" class="w-full h-72 object-cover">
                    <div class="p-4 bg-gradient-to-t from-black to-transparent">
                        <h3 class="text-xs font-bold truncate">${m.title}</h3>
                        <p class="text-[10px] text-[#d4af37] mt-1 font-mono">ENCRYPTED_LINK</p>
                    </div>
                `;
                card.onclick = () => openPlayer(m.id);
                grid.appendChild(card);
            });
        }

        // البحث اليدوي المباشر (الحقن الفوري)
        async function manualInject() {
            const query = document.getElementById('targetSearch').value;
            if(!query) return Swal.fire('خطأ', 'اكتب اسم الفيلم أولاً', 'error');

            try {
                const resp = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=${query}`);
                const data = await resp.json();
                if(data.results.length > 0) {
                    openPlayer(data.results[0].id);
                } else {
                    Swal.fire('لم نجد الفيلم', 'تأكد من كتابة الاسم بالإنجليزية بدقة', 'warning');
                }
            } catch (e) {
                // إذا كان البحث محظوراً، نستخدم تخمين الرابط المباشر
                const url = `https://vidsrc.to/embed/movie/${query.toLowerCase().replace(/ /g, '-')}`;
                document.getElementById('player-overlay').style.display = 'flex';
                document.getElementById('video-container').innerHTML = `<iframe src="${url}" allowfullscreen></iframe>`;
            }
        }

        function openPlayer(id) {
            const overlay = document.getElementById('player-overlay');
            const container = document.getElementById('video-container');
            // أفضل سيرفرات تدعم الترجمة العربية 4K
            const server = `https://vidsrc.to/embed/movie/${id}`;
            
            overlay.style.display = 'flex';
            container.innerHTML = `<iframe src="${server}" allowfullscreen></iframe>`;
        }

        function closePlayer() {
            document.getElementById('player-overlay').style.display = 'none';
            document.getElementById('video-container').innerHTML = '';
        }

        init();
    </script>
</body>
</html>
