<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>منظمة ليالي العرب | محرك الأفلام العالمي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;900&display=swap');
        body { background: #050505; color: white; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
        .gold-glow { text-shadow: 0 0 15px #d4af37; color: #d4af37; }
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; padding: 20px; }
        .movie-card { position: relative; border-radius: 10px; overflow: hidden; cursor: pointer; transition: 0.4s; border: 1px solid #111; }
        .movie-card:hover { transform: scale(1.05); border-color: #d4af37; }
        .movie-card img { width: 100%; height: 270px; object-fit: cover; }
        .movie-info { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, black); padding: 10px; font-size: 12px; }
        #player-overlay { position: fixed; inset: 0; background: black; z-index: 9999; display: none; }
        iframe { width: 100%; height: 100%; border: none; }
        .close-btn { position: absolute; top: 20px; left: 20px; background: #d4af37; color: black; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; z-index: 10000; }
        .search-box { background: #111; border: 1px solid #222; padding: 15px; border-radius: 50px; width: 100%; max-width: 500px; outline: none; transition: 0.3s; }
        .search-box:focus { border-color: #d4af37; box-shadow: 0 0 20px rgba(212,175,55,0.2); }
    </style>
</head>
<body>

    <nav class="p-6 flex justify-between items-center bg-black/50 sticky top-0 z-50 backdrop-blur-md border-b border-white/5">
        <div class="text-2xl font-black gold-glow tracking-tighter">LAYALI AL ARAB</div>
        <div class="flex-1 px-10">
            <input type="text" id="searchInput" placeholder="ابحث عن أي فيلم لسرقته..." class="search-box">
        </div>
        <div class="flex gap-4 items-center">
            <span class="text-xs text-green-500 font-bold"><i class="fas fa-signal"></i> SERVER: ACTIVE</span>
            <div class="w-10 h-10 rounded-full border-2 border-gold-glow flex items-center justify-center">
                <i class="fas fa-crown gold-glow text-sm"></i>
            </div>
        </div>
    </nav>

    <div class="p-8">
        <h2 class="text-xl font-black mb-6 flex items-center gap-2">
            <i class="fas fa-bolt text-yellow-500"></i> أحدث الأفلام المسحوبة عالمياً
        </h2>
        <div id="movieContainer" class="movie-grid">
            <div class="text-gray-500">جاري فحص القواعد البيانات...</div>
        </div>
    </div>

    <div id="player-overlay">
        <div class="close-btn" onclick="closePlayer()"><i class="fas fa-arrow-right"></i> إغلاق العرض</div>
        <div id="videoContainer" class="w-full h-full">
            </div>
    </div>

    <script>
        // مفتاح API تجريبي (لجلب البيانات)
        const API_KEY = '8d6d9194546435662aa063955619f697'; 
        const movieContainer = document.getElementById('movieContainer');

        // 1. جلب الأفلام التلقائي (Scraping Simulation)
        async function fetchMovies(query = '') {
            let url = query 
                ? `https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=${query}&language=ar`
                : `https://api.themoviedb.org/3/movie/popular?api_key=${API_KEY}&language=ar&page=1`;

            try {
                const res = await fetch(url);
                const data = await res.json();
                renderMovies(data.results);
            } catch (error) {
                movieContainer.innerHTML = "فشل الجلب، تأكد من الاتصال.";
            }
        }

        function renderMovies(movies) {
            movieContainer.innerHTML = '';
            movies.forEach(movie => {
                if(!movie.poster_path) return;
                const card = document.createElement('div');
                card.className = 'movie-card animate__animated animate__fadeIn';
                card.innerHTML = `
                    <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}">
                    <div class="movie-info">
                        <p class="font-bold truncate">${movie.title}</p>
                        <p class="text-[10px] text-yellow-500">${movie.release_date.split('-')[0]} | ★ ${movie.vote_average}</p>
                    </div>
                `;
                card.onclick = () => openPlayer(movie.id, movie.title);
                movieContainer.appendChild(card);
            });
        }

        // 2. محرك "السرقة" المباشر (توليد رابط البث)
        function openPlayer(id, title) {
            const playerOverlay = document.getElementById('player-overlay');
            const videoContainer = document.getElementById('videoContainer');
            
            // نستخدم سيرفرات وسيطة عالمية تقوم بجلب المحتوى تلقائياً بناءً على ID الفيلم
            // هذه السيرفرات تحاول إيجاد أفضل بث متاح
            const streamUrl = `https://vidsrc.me/embed/movie?tmdb=${id}`; 

            playerOverlay.style.display = 'block';
            videoContainer.innerHTML = `<iframe src="${streamUrl}" allowfullscreen></iframe>`;
            
            Swal.fire({
                toast: true, position: 'top-end',
                title: `جاري سحب بث: ${title}`,
                icon: 'success', showConfirmButton: false, timer: 3000,
                background: '#d4af37', color: '#000'
            });
        }

        function closePlayer() {
            document.getElementById('player-overlay').style.display = 'none';
            document.getElementById('videoContainer').innerHTML = '';
        }

        // البحث عند الضغط على Enter
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') fetchMovies(e.target.value);
        });

        // تشغيل الجلب عند فتح الموقع
        fetchMovies();
    </script>
</body>
</html>
