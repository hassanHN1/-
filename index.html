<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø¹Ø±Ø¨ | Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø±Ø³Ù…ÙŠ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap');
        
        :root {
            --gold-primary: #d4af37;
            --gold-shine: #fff8dc;
            --royal-blue: #0f172a;
            --deep-purple: #1e1b4b;
        }

        body { 
            background-color: #020617;
            background-image: 
                radial-gradient(circle at 50% 0%, #1e1b4b 0%, #020617 60%),
                url("https://www.transparenttextures.com/patterns/stardust.png");
            color: white; 
            font-family: 'Tajawal', sans-serif; 
            overflow-x: hidden;
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø²Ø¬Ø§Ø¬ ÙˆØ§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© */
        .glass-panel {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .gold-border { border: 1px solid var(--gold-primary); }
        .gold-text { 
            background: linear-gradient(to bottom, #ffd700, #b8860b); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        /* Ø²Ø± Ø¬ÙˆØ¬Ù„ */
        .google-btn {
            background: white; color: #333;
            transition: 0.3s; position: relative; overflow: hidden;
        }
        .google-btn:hover { background: #f1f1f1; transform: translateY(-2px); }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± */
        .ticker-wrap {
            position: fixed; bottom: 0; width: 100%; overflow: hidden; height: 30px;
            background: rgba(0,0,0,0.9); border-top: 1px solid #333; z-index: 50;
            line-height: 30px;
        }
        .ticker { display: inline-block; white-space: nowrap; animation: ticker 20s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† */
        .float { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-20px); } 100% { transform: translateY(0px); } }
    </style>
</head>
<body class="antialiased selection:bg-yellow-500 selection:text-black">

    <div class="fixed inset-0 pointer-events-none z-0">
        <div class="absolute top-0 left-10 text-yellow-500/20 text-9xl float" style="animation-delay: 1s;"><i class="fas fa-moon"></i></div>
        <div class="absolute top-20 right-20 text-yellow-500/10 text-8xl float" style="animation-delay: 2s;"><i class="fas fa-mosque"></i></div>
    </div>

    <div id="authScreen" class="min-h-screen flex flex-col items-center justify-center p-4 relative z-10">
        <div class="glass-panel p-8 rounded-[2.5rem] w-full max-w-md text-center border-t-4 border-yellow-500 animate__animated animate__fadeInDown">
            
            <div class="w-24 h-24 bg-yellow-500/10 rounded-full mx-auto flex items-center justify-center mb-4 border border-yellow-500/50 shadow-[0_0_30px_rgba(255,215,0,0.2)]">
                <i class="fas fa-kaaba text-4xl text-yellow-400"></i>
            </div>

            <h1 class="text-4xl font-black mb-2 gold-text">Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø¹Ø±Ø¨</h1>
            <p class="text-gray-400 text-sm mb-8">Ù…Ù†ØµØ© Ø§Ù„ØªØ±Ø§Ø« ÙˆØ§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø£ÙˆÙ„</p>

            <div class="space-y-4">
                <button onclick="simulateGoogleLogin()" class="google-btn w-full py-3 rounded-xl font-bold flex items-center justify-center gap-3 shadow-lg">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" class="w-5 h-5">
                    <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Google</span>
                </button>

                <div class="flex items-center gap-2 text-xs text-gray-500 my-4">
                    <span class="h-px bg-gray-700 flex-1"></span>
                    <span>Ø£Ùˆ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ²Ø§Ø¦Ø±</span>
                    <span class="h-px bg-gray-700 flex-1"></span>
                </div>

                <input type="text" id="guestName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±..." class="w-full bg-black/50 border border-gray-700 rounded-xl p-3 text-center text-white focus:border-yellow-500 focus:outline-none transition">
                
                <button onclick="guestLogin()" class="w-full bg-gradient-to-r from-yellow-600 to-yellow-800 hover:from-yellow-500 hover:to-yellow-700 text-white font-bold py-3 rounded-xl shadow-lg transition transform hover:scale-[1.02]">
                    <i class="fas fa-door-open ml-2"></i> Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®ÙŠÙ…Ø©
                </button>
            </div>
            
            <p class="mt-6 text-[10px] text-gray-500">
                <i class="fas fa-shield-alt text-green-500"></i> Ø§ØªØµØ§Ù„ Ø¢Ù…Ù† ÙˆÙ…Ø´ÙØ± | Ø§Ù„Ø¥ØµØ¯Ø§Ø± V3.0
            </p>
        </div>
    </div>

    <div id="mainApp" class="hidden min-h-screen pb-12 relative z-10">
        
        <nav class="glass-panel sticky top-0 z-50 px-6 py-4 flex justify-between items-center rounded-b-3xl mx-2 mt-2">
            <div class="flex items-center gap-4">
                <div class="relative cursor-pointer group" onclick="editProfile()">
                    <img id="navAvatar" src="" class="w-12 h-12 rounded-full border-2 border-yellow-500 object-cover">
                    <div class="absolute bottom-0 right-0 w-4 h-4 bg-green-500 rounded-full border-2 border-black"></div>
                    <div class="absolute inset-0 bg-black/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition text-[10px]">ØªØ¹Ø¯ÙŠÙ„</div>
                </div>
                <div>
                    <h3 id="navName" class="font-bold text-lg text-white leading-tight">--</h3>
                    <div class="text-xs text-yellow-500 font-mono bg-yellow-500/10 px-2 rounded-lg inline-block mt-1">
                        <i class="fas fa-coins text-[10px]"></i> <span id="navGold">0</span>
                    </div>
                </div>
            </div>
            
            <div class="flex gap-3">
                <button onclick="logout()" class="w-10 h-10 rounded-full bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition flex items-center justify-center">
                    <i class="fas fa-power-off"></i>
                </button>
            </div>
        </nav>

        <div class="container mx-auto px-4 mt-8">
            
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                
                <div class="lg:col-span-1 space-y-6">
                    <div class="glass-panel p-6 rounded-3xl text-center relative overflow-hidden">
                        <div class="absolute top-0 right-0 bg-yellow-500 text-black text-[10px] font-bold px-3 py-1 rounded-bl-xl">Ø¬Ø¯ÙŠØ¯</div>
                        <h2 class="text-xl font-bold mb-2">ğŸŒ™ Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙŠØ§ <span id="welcomeName" class="text-yellow-400"></span></h2>
                        <p class="text-xs text-gray-400 mb-4">ØªÙ… Ø§ÙØªØªØ§Ø­ Ø§Ù„Ù…Ù†ØµØ© Ø±Ø³Ù…ÙŠØ§Ù‹ Ø¨ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…!</p>
                        <div class="bg-white/5 rounded-xl p-3 border border-white/10">
                            <div class="text-2xl font-black text-white" id="onlineCount">1,240</div>
                            <div class="text-[10px] text-gray-400">Ø¹Ø¶Ùˆ Ù†Ø´Ø· Ø§Ù„Ø¢Ù†</div>
                        </div>
                    </div>

                    <div class="glass-panel p-5 rounded-3xl border border-yellow-500/30">
                        <h3 class="font-bold text-yellow-500 flex items-center gap-2 mb-4">
                            <i class="fas fa-crown text-xl animate-pulse"></i> ÙƒØ¨Ø§Ø± Ø§Ù„Ø¯Ø§Ø¹Ù…ÙŠÙ†
                        </h3>
                        <div id="supportersList" class="space-y-3">
                            </div>
                        <button onclick="becomeSupporter()" class="w-full mt-4 bg-yellow-600/20 hover:bg-yellow-600/40 text-yellow-400 text-xs py-2 rounded-xl transition border border-yellow-500/30">
                            ÙƒÙ† Ø¯Ø§Ø¹Ù…Ø§Ù‹ Ø§Ù„Ø¢Ù†
                        </button>
                    </div>
                </div>

                <div class="lg:col-span-3">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold flex items-center gap-2">
                            <i class="fas fa-tent text-emerald-500"></i> Ø§Ù„Ø®ÙŠÙ… Ø§Ù„Ù†Ø´Ø·Ø©
                        </h2>
                        <button onclick="createRoomPrompt()" class="bg-emerald-600 hover:bg-emerald-500 text-white px-5 py-2 rounded-xl text-sm font-bold shadow-lg shadow-emerald-500/20 transition flex items-center gap-2">
                            <i class="fas fa-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø®ÙŠÙ…Ø©
                        </button>
                    </div>

                    <div id="roomsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div id="roomInterface" class="hidden fixed inset-0 z-50 bg-[#020617] flex flex-col animate__animated animate__zoomIn">
        <header class="h-16 border-b border-white/10 bg-black/40 flex justify-between items-center px-4">
            <div class="flex items-center gap-3">
                <button onclick="leaveRoom()" class="text-gray-400 hover:text-white"><i class="fas fa-arrow-right"></i></button>
                <div>
                    <h3 id="currentRoomTitle" class="font-bold text-white">---</h3>
                    <span class="text-[10px] text-green-400 flex items-center gap-1"><span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span> Ù…ØªØµÙ„</span>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="donateInRoom()" class="bg-yellow-500 text-black px-3 py-1 rounded-full text-xs font-bold hover:bg-yellow-400 transition animate-bounce">
                    <i class="fas fa-gift"></i> Ø¯Ø¹Ù…
                </button>
                <div class="bg-white/10 px-3 py-1 rounded-lg text-xs font-mono" id="roomCodeDisplay">CODE</div>
            </div>
        </header>

        <div class="flex-1 flex overflow-hidden">
            <div class="flex-1 flex flex-col bg-image-pattern">
                <div id="chatContainer" class="flex-1 overflow-y-auto p-4 space-y-4">
                    </div>
                
                <div class="p-4 bg-black/60 backdrop-blur border-t border-white/10">
                    <div class="flex gap-2 relative">
                        <button onclick="sendLike()" class="text-red-500 hover:scale-125 transition"><i class="fas fa-heart"></i></button>
                        <input type="text" id="msgInput" placeholder="Ø´Ø§Ø±ÙƒÙ†Ø§ Ø§Ù„Ø­Ø¯ÙŠØ«..." class="flex-1 bg-white/5 border border-white/10 rounded-full px-4 py-2 text-sm text-white focus:border-yellow-500 outline-none">
                        <button onclick="sendMessage()" class="w-10 h-10 bg-yellow-600 rounded-full text-white shadow-lg hover:bg-yellow-500 transition"><i class="fas fa-paper-plane text-xs"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="ticker-wrap">
        <div class="ticker text-xs text-yellow-500">
            ğŸŒ™ ØªÙ… Ø§ÙØªØªØ§Ø­ Ù…Ù†ØµØ© "Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø¹Ø±Ø¨" Ø±Ø³Ù…ÙŠØ§Ù‹ Ø§Ù„ÙŠÙˆÙ…! | ğŸ“¢ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©: Ù†Ø±Ø­Ø¨ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯ | ğŸ† Ù…Ø³Ø§Ø¨Ù‚Ø© "Ø£Ø¬Ù…Ù„ ÙØ§Ù†ÙˆØ³" ØªØ¨Ø¯Ø£ Ù‚Ø±ÙŠØ¨Ø§Ù‹ | ğŸ’ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¯Ø¹Ù… Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ Ø¨Ø§Ù„Ø°Ù‡Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„ØºØ±Ù
        </div>
    </div>

    <script>
        // --- 1. Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© (Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø³ÙŠØ±ÙØ±) ---
        const DB_KEY = 'LayaliApp_V3_Data';
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        const defaultData = {
            user: null, // {name, avatar, gold, type: 'guest'|'google'}
            supporters: [
                { name: "Ø§Ù„Ø´ÙŠØ® ÙÙ‡Ø¯", gold: 15000, avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=fahad" },
                { name: "Ø§Ù„Ø£Ù…ÙŠØ±Ø© Ø³Ø§Ø±Ø©", gold: 8500, avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=sara" },
                { name: "Ø£Ø¨Ùˆ Ø§Ù„Ø¹Ø²", gold: 5000, avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=abuelzz" }
            ],
            rooms: [
                { id: 'RM01', name: 'Ù…Ø¬Ù„Ø³ Ø§Ù„Ø³ÙˆØ§Ù„Ù', host: 'Ø§Ù„Ù†Ø¸Ø§Ù…', users: 15 },
                { id: 'RM02', name: 'Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø±Ù…Ø¶Ø§Ù†ÙŠØ©', host: 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', users: 42 },
                { id: 'RM03', name: 'ØªÙ„Ø§ÙˆØ§Øª Ø®Ø§Ø´Ø¹Ø©', host: 'Ø§Ù„Ù‚Ø§Ø±Ø¦', users: 8 }
            ]
        };

        let appData = JSON.parse(localStorage.getItem(DB_KEY)) || defaultData;

        function saveData() {
            localStorage.setItem(DB_KEY, JSON.stringify(appData));
        }

        // --- 2. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ---
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡
        if (appData.user) {
            showDashboard();
        }

        function simulateGoogleLogin() {
            Swal.fire({
                title: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google...',
                text: 'ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ø­Ø¸Ø§Øª',
                timer: 2000,
                didOpen: () => Swal.showLoading()
            }).then(() => {
                // Ù…Ø­Ø§ÙƒØ§Ø© Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¯Ø®ÙˆÙ„
                const randomName = "Ù…Ø³ØªØ®Ø¯Ù… Ø¬ÙˆØ¬Ù„ " + Math.floor(Math.random() * 100);
                loginUser(randomName, 'google');
            });
        }

        function guestLogin() {
            const name = document.getElementById('guestName').value.trim();
            if (name.length < 3) return Swal.fire('ØªÙ†Ø¨ÙŠÙ‡', 'Ø§Ù„Ø§Ø³Ù… Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹', 'warning');
            loginUser(name, 'guest');
        }

        function loginUser(name, type) {
            appData.user = {
                name: name,
                avatar: `https://api.dicebear.com/7.x/avataaars/svg?seed=${name}`,
                gold: 500, // Ù‡Ø¯ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                type: type,
                joined: new Date().toLocaleDateString()
            };
            saveData();
            
            Swal.fire({
                icon: 'success',
                title: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­',
                text: 'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø¹Ø±Ø¨',
                timer: 1500,
                showConfirmButton: false
            }).then(() => showDashboard());
        }

        function logout() {
            appData.user = null;
            saveData();
            location.reload();
        }

        // --- 3. Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ---
        function showDashboard() {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('animate__animated', 'animate__fadeIn');

            updateNavBar();
            renderSupporters();
            renderRooms();
            
            // Ø¹Ø¯Ø§Ø¯ ÙˆÙ‡Ù…ÙŠ ÙŠØ²ÙŠØ¯ Ø§Ù„ØªÙØ§Ø¹Ù„
            setInterval(() => {
                const count = document.getElementById('onlineCount');
                let current = parseInt(count.innerText.replace(',', ''));
                count.innerText = (current + Math.floor(Math.random() * 5) - 2).toLocaleString();
            }, 3000);
        }

        function updateNavBar() {
            const u = appData.user;
            document.getElementById('navName').innerText = u.name;
            document.getElementById('welcomeName').innerText = u.name;
            document.getElementById('navAvatar').src = u.avatar;
            document.getElementById('navGold').innerText = u.gold.toLocaleString();
        }

        function editProfile() {
            Swal.fire({
                title: 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ',
                html: `
                    <div class="mb-4"><img src="${appData.user.avatar}" class="w-20 h-20 mx-auto rounded-full border-2 border-yellow-500"></div>
                    <button onclick="changeUserAvatar()" class="text-xs text-blue-400 underline mb-4">ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©</button>
                    <input id="newProfileName" class="swal2-input" value="${appData.user.name}">
                `,
                confirmButtonText: 'Ø­ÙØ¸',
                confirmButtonColor: '#d4af37',
                preConfirm: () => {
                    const newName = document.getElementById('newProfileName').value;
                    if(newName) {
                        appData.user.name = newName;
                        appData.user.avatar = `https://api.dicebear.com/7.x/avataaars/svg?seed=${newName}`; // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§ÙØªØ§Ø± Ù…Ø¹ Ø§Ù„Ø§Ø³Ù…
                        saveData();
                        updateNavBar();
                    }
                }
            });
        }
        
        function changeUserAvatar() {
            // Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
            appData.user.avatar = `https://api.dicebear.com/7.x/avataaars/svg?seed=${Math.random()}`;
            saveData();
            updateNavBar();
            Swal.close(); // Ø¥ØºÙ„Ø§Ù‚ ÙˆØªØ­Ø¯ÙŠØ«
            Swal.fire('ØªÙ…!', 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø©', 'success');
        }

        // --- 4. Ù„ÙˆØ­Ø© Ø§Ù„Ø¯Ø§Ø¹Ù…ÙŠÙ† ---
        function renderSupporters() {
            const list = document.getElementById('supportersList');
            list.innerHTML = '';
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¯Ø§Ø¹Ù…ÙŠÙ†
            const sorted = [...appData.supporters].sort((a, b) => b.gold - a.gold);

            sorted.forEach((s, index) => {
                const medal = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : 'ğŸ¥‰';
                list.innerHTML += `
                    <div class="flex items-center justify-between bg-black/40 p-2 rounded-lg border border-white/5">
                        <div class="flex items-center gap-2">
                            <span class="text-lg">${index < 3 ? medal : '#'+(index+1)}</span>
                            <img src="${s.avatar}" class="w-8 h-8 rounded-full border border-yellow-500/30">
                            <span class="text-xs font-bold text-gray-200">${s.name}</span>
                        </div>
                        <span class="text-[10px] text-yellow-500 font-mono">${s.gold.toLocaleString()}</span>
                    </div>
                `;
            });
        }

        function becomeSupporter() {
            Swal.fire({
                title: 'Ø¯Ø¹Ù… Ø§Ù„Ù…Ù†ØµØ©',
                text: 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù€ 100 Ø°Ù‡Ø¨Ø© Ù„Ù„Ø¸Ù‡ÙˆØ± ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŸ',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø§Ø¯Ø¹Ù…',
                confirmButtonColor: '#d4af37'
            }).then((res) => {
                if (res.isConfirmed) {
                    if(appData.user.gold >= 100) {
                        appData.user.gold -= 100;
                        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© Ù…Ø¤Ù‚ØªØ§Ù‹
                        const existing = appData.supporters.find(s => s.name === appData.user.name);
                        if(existing) existing.gold += 100;
                        else appData.supporters.push({ name: appData.user.name, gold: 100, avatar: appData.user.avatar });
                        
                        saveData();
                        updateNavBar();
                        renderSupporters();
                        Swal.fire('Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ!', 'Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…Ù† Ù†Ø®Ø¨Ø© Ø§Ù„Ø¯Ø§Ø¹Ù…ÙŠÙ†', 'success');
                    } else {
                        Swal.fire('Ø¹Ø°Ø±Ø§Ù‹', 'Ù„Ø§ ØªÙ…Ù„Ùƒ Ø°Ù‡Ø¨Ø§Ù‹ ÙƒØ§ÙÙŠØ§Ù‹', 'error');
                    }
                }
            });
        }

        // --- 5. Ù†Ø¸Ø§Ù… Ø§Ù„ØºØ±Ù ---
        function renderRooms() {
            const grid = document.getElementById('roomsGrid');
            grid.innerHTML = '';
            
            appData.rooms.forEach(room => {
                grid.innerHTML += `
                    <div onclick="enterRoom('${room.name}', '${room.id}')" class="group bg-white/5 hover:bg-white/10 border border-white/10 hover:border-yellow-500/50 p-5 rounded-2xl cursor-pointer transition relative overflow-hidden">
                        <div class="absolute -right-4 -top-4 w-20 h-20 bg-yellow-500/20 blur-2xl rounded-full group-hover:bg-yellow-500/30 transition"></div>
                        
                        <div class="flex justify-between items-start mb-3">
                            <div class="bg-blue-900/50 p-2 rounded-lg text-blue-300">
                                <i class="fas fa-users"></i>
                            </div>
                            <span class="text-[10px] bg-green-900/50 text-green-400 px-2 py-1 rounded">Ù…Ø¨Ø§Ø´Ø±</span>
                        </div>
                        
                        <h4 class="font-bold text-lg mb-1">${room.name}</h4>
                        <p class="text-xs text-gray-400 mb-3">Ø§Ù„Ù…Ø¶ÙŠÙ: ${room.host}</p>
                        
                        <div class="flex items-center gap-2 text-xs text-gray-500">
                            <i class="fas fa-user-friends"></i> ${room.users} Ù…ØªØµÙ„
                        </div>
                    </div>
                `;
            });
        }

        async function createRoomPrompt() {
            const { value: formValues } = await Swal.fire({
                title: 'Ø¥Ù†Ø´Ø§Ø¡ Ø®ÙŠÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©',
                html: '<input id="swal-input1" class="swal2-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø®ÙŠÙ…Ø©">',
                confirmButtonText: 'Ø¥Ù†Ø´Ø§Ø¡',
                confirmButtonColor: '#10b981',
                preConfirm: () => document.getElementById('swal-input1').value
            });

            if (formValues) {
                const newId = 'RM' + Math.floor(Math.random() * 1000);
                const newRoom = { id: newId, name: formValues, host: appData.user.name, users: 1 };
                appData.rooms.unshift(newRoom);
                saveData();
                renderRooms();
                enterRoom(newRoom.name, newId);
            }
        }

        // --- 6. Ø¯Ø§Ø®Ù„ Ø§Ù„ØºØ±ÙØ© ÙˆØ§Ù„Ø´Ø§Øª ---
        let currentRoomId = null;

        function enterRoom(name, id) {
            currentRoomId = id;
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('roomInterface').classList.remove('hidden');
            document.getElementById('currentRoomTitle').innerText = name;
            document.getElementById('roomCodeDisplay').innerText = id;
            
            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø´Ø§Øª ÙˆØ¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
            const chat = document.getElementById('chatContainer');
            chat.innerHTML = `<div class="text-center text-xs text-gray-500 my-4">-- Ø§Ù†Ø¶Ù… ${appData.user.name} Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø© --</div>`;
        }

        function leaveRoom() {
            document.getElementById('roomInterface').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            currentRoomId = null;
        }

        function sendMessage() {
            const inp = document.getElementById('msgInput');
            const txt = inp.value.trim();
            if(!txt) return;

            appendMessage(txt, true);
            inp.value = '';

            // Ù…Ø­Ø§ÙƒØ§Ø© Ø±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„ØªØ´Ø¹Ø± Ø¨Ø§Ù„Ø­ÙŠØ§Ø©
            setTimeout(() => {
                const responses = ["Ù…Ù†ÙˆØ± ÙŠØ§ ØºØ§Ù„ÙŠ ğŸŒ¹", "Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…!", "ØµØ­ Ù„Ø³Ø§Ù†Ùƒ", "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ"];
                const randResp = responses[Math.floor(Math.random() * responses.length)];
                appendMessage(randResp, false, "Ø¹Ø¶Ùˆ Ø¹Ø´ÙˆØ§Ø¦ÙŠ");
            }, 2000);
        }

        function appendMessage(text, isMe, senderName = null) {
            const chat = document.getElementById('chatContainer');
            const name = isMe ? appData.user.name : (senderName || "Ø¶ÙŠÙ");
            const avatar = isMe ? appData.user.avatar : `https://api.dicebear.com/7.x/avataaars/svg?seed=${name}`;
            
            const div = document.createElement('div');
            div.className = `flex gap-2 items-end ${isMe ? 'flex-row-reverse' : ''} animate__animated animate__fadeInUp`;
            
            div.innerHTML = `
                <img src="${avatar}" class="w-8 h-8 rounded-full border border-gray-600">
                <div class="${isMe ? 'bg-yellow-600 text-white rounded-l-2xl rounded-tr-2xl' : 'bg-gray-800 text-gray-200 rounded-r-2xl rounded-tl-2xl'} px-4 py-2 max-w-[70%] text-sm shadow-md">
                    <p class="text-[10px] opacity-50 mb-1 ${isMe ? 'text-right' : ''}">${name}</p>
                    ${text}
                </div>
            `;
            
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }

        function donateInRoom() {
            if(appData.user.gold >= 50) {
                appData.user.gold -= 50;
                saveData();
                updateNavBar();
                
                // Ø±Ø³Ø§Ù„Ø© Ø®Ø§ØµØ© Ù„Ù„Ø¯Ø¹Ù…
                const chat = document.getElementById('chatContainer');
                chat.innerHTML += `
                    <div class="text-center my-4 animate__animated animate__heartBeat">
                        <span class="bg-yellow-500/20 text-yellow-500 border border-yellow-500 px-3 py-1 rounded-full text-xs font-bold">
                            ğŸ’ Ø£Ø±Ø³Ù„ ${appData.user.name} Ù‡Ø¯ÙŠØ© Ø°Ù‡Ø¨ÙŠØ©!
                        </span>
                    </div>
                `;
                chat.scrollTop = chat.scrollHeight;
            } else {
                Swal.fire('ØªÙ†Ø¨ÙŠÙ‡', 'Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙ', 'warning');
            }
        }

        function sendLike() {
             const chat = document.getElementById('chatContainer');
             // Ø¥Ø¶Ø§ÙØ© Ù‚Ù„ÙˆØ¨ Ø·Ø§Ø¦Ø±Ø© (ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ ÙÙ‚Ø·)
             const heart = document.createElement('div');
             heart.innerHTML = 'â¤ï¸';
             heart.style.position = 'fixed';
             heart.style.left = Math.random() * 80 + 10 + '%';
             heart.style.bottom = '100px';
             heart.style.fontSize = '2rem';
             heart.style.animation = 'float 2s ease-out forwards';
             heart.style.zIndex = '100';
             document.body.appendChild(heart);
             setTimeout(() => heart.remove(), 2000);
        }

    </script>
</body>
</html>
